\begin{Verbatim}[commandchars=\\\{\}]
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}stdio.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}stdlib.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}stddef.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}stdbool.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}argp.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}string.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}time.h\PYGdefaultZgt{}}

\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}mkl.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}math.h\PYGdefaultZgt{}}

\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}mpi.h\PYGdefaultZgt{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZlt{}omp.h\PYGdefaultZgt{}}

\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZdq{}load\PYGdefaultZus{}matrix.h\PYGdefaultZdq{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZdq{}save\PYGdefaultZus{}matrix.h\PYGdefaultZdq{}}
\PYGdefault{c+cp}{\PYGdefaultZsh{}include \PYGdefaultZdq{}save\PYGdefaultZus{}info.h\PYGdefaultZdq{}}

\PYGdefault{c+cp}{\PYGdefaultZsh{}define ROOT 0}
\PYGdefault{c+cp}{\PYGdefaultZsh{}define DISTRIBUTION\PYGdefaultZus{}A 1337}
\PYGdefault{c+cp}{\PYGdefaultZsh{}define DISTRIBUTION\PYGdefaultZus{}B 1338 }
\PYGdefault{c+cp}{\PYGdefaultZsh{}define SKEW\PYGdefaultZus{}LEFTRIGHT 23}
\PYGdefault{c+cp}{\PYGdefaultZsh{}define SKEW\PYGdefaultZus{}BOTTOMUP 93}
\PYGdefault{c+cp}{\PYGdefaultZsh{}define COLLECTING 42}
\PYGdefault{c+cp}{\PYGdefaultZsh{}define COMMUNICATION\PYGdefaultZus{}TIME 44}

\PYGdefault{k}{const} \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{argp\PYGdefaultZus{}program\PYGdefaultZus{}version} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}pmm v0.1\PYGdefaultZdq{}}\PYGdefault{p}{;}
\PYGdefault{k}{const} \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{argp\PYGdefaultZus{}program\PYGdefaultZus{}bug\PYGdefaultZus{}address} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZlt{}rafal.szczerski@gmail.com\PYGdefaultZgt{}\PYGdefaultZdq{}}\PYGdefault{p}{;}
\PYGdefault{k}{static} \PYGdefault{k+kt}{char} \PYGdefault{n}{doc}\PYGdefault{p}{[]} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}Parallel Matrix Multiplication\PYGdefaultZdq{}}\PYGdefault{p}{;}
\PYGdefault{k}{static} \PYGdefault{k+kt}{char} \PYGdefault{n}{args\PYGdefaultZus{}doc}\PYGdefault{p}{[]} \PYGdefault{o}{=} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZhy{}A matrixA\PYGdefaultZus{}path \PYGdefaultZhy{}B matrixB\PYGdefaultZus{}path \PYGdefaultZhy{}m NUM \PYGdefaultZhy{}k NUM \PYGdefaultZhy{}n NUM\PYGdefaultZdq{}}\PYGdefault{p}{;}

\PYGdefault{k}{static} \PYGdefault{k}{struct} \PYGdefault{n}{argp\PYGdefaultZus{}option} \PYGdefault{n}{options}\PYGdefault{p}{[]} \PYGdefault{o}{=} \PYGdefault{p}{\PYGdefaultZob{}}
    \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{l+s}{\PYGdefaultZdq{}method\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}a\PYGdefaultZsq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}METHOD\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Algorithm used\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{l+s}{\PYGdefaultZdq{}inputA\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}A\PYGdefaultZsq{}}\PYGdefault{p}{,}   \PYGdefault{l+s}{\PYGdefaultZdq{}FILE\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Path to input FILE containing matrix A data\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{l+s}{\PYGdefaultZdq{}inputB\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}B\PYGdefaultZsq{}}\PYGdefault{p}{,}   \PYGdefault{l+s}{\PYGdefaultZdq{}FILE\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Path to input FILE containing matrix B data\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{l+s}{\PYGdefaultZdq{}output\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}o\PYGdefaultZsq{}}\PYGdefault{p}{,}   \PYGdefault{l+s}{\PYGdefaultZdq{}FILE\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{OPTION\PYGdefaultZus{}ARG\PYGdefaultZus{}OPTIONAL}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Path to output FILE containing matrix C=A*B data\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}C\PYGdefaultZsq{}}\PYGdefault{p}{,}   \PYGdefault{l+s}{\PYGdefaultZdq{}FILE\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{OPTION\PYGdefaultZus{}ALIAS}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}  \PYGdefault{l+s}{\PYGdefaultZdq{}debug\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}d\PYGdefaultZsq{}}\PYGdefault{p}{,}    \PYGdefault{l+s}{\PYGdefaultZdq{}DIR\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{OPTION\PYGdefaultZus{}ARG\PYGdefaultZus{}OPTIONAL}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Path to debug directory\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}m\PYGdefaultZsq{}}\PYGdefault{p}{,}    \PYGdefault{l+s}{\PYGdefaultZdq{}NUM\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Number of rows of A\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}k\PYGdefaultZsq{}}\PYGdefault{p}{,}    \PYGdefault{l+s}{\PYGdefaultZdq{}NUM\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Number of rows of B\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}n\PYGdefaultZsq{}}\PYGdefault{p}{,}    \PYGdefault{l+s}{\PYGdefaultZdq{}NUM\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Number of columns of B\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}   \PYGdefault{l+s}{\PYGdefaultZdq{}list\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}l\PYGdefaultZsq{}}\PYGdefault{p}{,}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Show list of available algorithms\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}   \PYGdefault{l+s}{\PYGdefaultZdq{}time\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}t\PYGdefaultZsq{}}\PYGdefault{p}{,}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Show elapsed time\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}  \PYGdefault{l+s}{\PYGdefaultZdq{}quiet\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}q\PYGdefaultZsq{}}\PYGdefault{p}{,}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Do not show any computations\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}  \PYGdefault{l+s}{\PYGdefaultZdq{}steps\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}s\PYGdefaultZsq{}}\PYGdefault{p}{,}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Dump data from each node for every step\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}\PYGdefault{l+s}{\PYGdefaultZdq{}verbose\PYGdefaultZdq{}}\PYGdefault{p}{,}     \PYGdefault{l+s+sc}{\PYGdefaultZsq{}v\PYGdefaultZsq{}}\PYGdefault{p}{,}        \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}Show all computations\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}}\PYGdefault{l+s}{\PYGdefaultZdq{}omp\PYGdefaultZus{}threads\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{777}\PYGdefault{p}{,}    \PYGdefault{l+s}{\PYGdefaultZdq{}NUM\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{OPTION\PYGdefaultZus{}HIDDEN}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{\PYGdefaultZcb{},}
    \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{l+m+mi}{0} \PYGdefault{p}{\PYGdefaultZcb{}} 
\PYGdefault{p}{\PYGdefaultZcb{};}

\PYGdefault{k}{struct} \PYGdefault{n}{arguments} \PYGdefault{p}{\PYGdefaultZob{}}
    \PYGdefault{k}{enum} \PYGdefault{p}{\PYGdefaultZob{}}\PYGdefault{n}{SEQUENTIAL}\PYGdefault{p}{,} \PYGdefault{n}{MKL}\PYGdefault{p}{,} \PYGdefault{n}{OMP}\PYGdefault{p}{,} \PYGdefault{n}{CANNON}\PYGdefault{p}{,} \PYGdefault{n}{CANNON\PYGdefaultZus{}DGEMM}\PYGdefault{p}{,} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}\PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{n}{method}\PYGdefault{p}{;}
    \PYGdefault{k}{enum} \PYGdefault{p}{\PYGdefaultZob{}}\PYGdefault{n}{QUIET}\PYGdefault{p}{,} \PYGdefault{n}{VERBOSE}\PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{n}{mode}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{bool} \PYGdefault{n}{time}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{bool} \PYGdefault{n}{steps}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{int} \PYGdefault{n}{omp\PYGdefaultZus{}threads}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{int} \PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{n}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{pathA}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{pathB}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{pathC}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{debugDir}\PYGdefault{p}{;}
\PYGdefault{p}{\PYGdefaultZcb{};}

\PYGdefault{k}{static} \PYGdefault{k+kt}{error\PYGdefaultZus{}t} \PYGdefault{n+nf}{parse\PYGdefaultZus{}opt}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{key}\PYGdefault{p}{,} \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{arg}\PYGdefault{p}{,} \PYGdefault{k}{struct} \PYGdefault{n}{argp\PYGdefaultZus{}state} \PYGdefault{o}{*}\PYGdefault{n}{state}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
    \PYGdefault{k}{struct} \PYGdefault{n}{arguments} \PYGdefault{o}{*}\PYGdefault{n}{arguments} \PYGdefault{o}{=} \PYGdefault{n}{state}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{input}\PYGdefault{p}{;}
    \PYGdefault{k}{switch} \PYGdefault{p}{(}\PYGdefault{n}{key}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}        
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}a\PYGdefaultZsq{}}:
        \PYGdefault{p}{\PYGdefaultZob{}}   
            \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{name} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{13} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{\PYGdefaultZlt{}}\PYGdefault{l+m+mi}{13} \PYGdefault{p}{;} \PYGdefault{n}{arg}\PYGdefault{o}{++}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)}
                \PYGdefault{n}{name}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{tolower}\PYGdefault{p}{(}\PYGdefault{o}{*}\PYGdefault{n}{arg}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}mkl\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{MKL}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}sequential\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{SEQUENTIAL}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}omp\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)} 
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{OMP}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}cannon\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{CANNON}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}cannon\PYGdefaultZus{}dgemm\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{CANNON\PYGdefaultZus{}DGEMM}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{strncmp}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}cannon\PYGdefaultZus{}omp\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{name}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)} \PYGdefault{o}{==} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}\PYGdefault{p}{;}
            \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{c+cm}{/* exit if there\PYGdefaultZsq{}s no such method */}
                \PYGdefault{n}{argp\PYGdefaultZus{}usage}\PYGdefault{p}{(}\PYGdefault{n}{state}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{c+c1}{// cannon\PYGdefaultZus{}dgemm method is set as default}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}A\PYGdefaultZsq{}}: \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{pathA} \PYGdefault{o}{=} \PYGdefault{n}{arg}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}B\PYGdefaultZsq{}}: \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{pathB} \PYGdefault{o}{=} \PYGdefault{n}{arg}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}C\PYGdefaultZsq{}}:
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}o\PYGdefaultZsq{}}: \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{)} \PYGdefault{o}{!=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{pathC} \PYGdefault{o}{=} \PYGdefault{n}{arg}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}d\PYGdefaultZsq{}}: \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{[}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{)}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{!=} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}/\PYGdefaultZsq{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k+kt}{char} \PYGdefault{n}{parg}\PYGdefault{p}{[}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{)}\PYGdefault{o}{+}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                \PYGdefault{n}{strncpy}\PYGdefault{p}{(}\PYGdefault{n}{parg}\PYGdefault{p}{,} \PYGdefault{n}{arg}\PYGdefault{p}{,} \PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{));}
                \PYGdefault{n}{parg}\PYGdefault{p}{[}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{)]} \PYGdefault{o}{=} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}/\PYGdefaultZsq{}}\PYGdefault{p}{;}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{debugDir} \PYGdefault{o}{=} \PYGdefault{n}{parg}\PYGdefault{p}{;}
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{debugDir} \PYGdefault{o}{=} \PYGdefault{n}{arg}\PYGdefault{p}{;}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}l\PYGdefaultZsq{}}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}Available methods:}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
            \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{availableMethods}\PYGdefault{p}{[]} \PYGdefault{o}{=} \PYGdefault{p}{\PYGdefaultZob{}}\PYGdefault{l+s}{\PYGdefaultZdq{}Sequential\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}MKL\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                \PYGdefault{l+s}{\PYGdefaultZdq{}OMP\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZus{}DGEMM\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZus{}OMP\PYGdefaultZdq{}}\PYGdefault{p}{\PYGdefaultZcb{};}
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}=} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}\PYGdefault{p}{;} \PYGdefault{o}{++}\PYGdefault{n}{i}\PYGdefault{p}{)}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}d \PYGdefaultZhy{} \PYGdefaultZpc{}s}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{,} \PYGdefault{n}{availableMethods}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}            
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}m\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{m} \PYGdefault{o}{=} \PYGdefault{n}{atoi}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}n\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{n} \PYGdefault{o}{=} \PYGdefault{n}{atoi}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}k\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{n}{atoi}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}t\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{time} \PYGdefault{o}{=} \PYGdefault{n+nb}{true}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}q\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{mode} \PYGdefault{o}{=} \PYGdefault{n}{QUIET}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}v\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{mode} \PYGdefault{o}{=} \PYGdefault{n}{VERBOSE}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+s+sc}{\PYGdefaultZsq{}s\PYGdefaultZsq{}}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{steps} \PYGdefault{o}{=} \PYGdefault{n+nb}{true}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{777}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{omp\PYGdefaultZus{}threads} \PYGdefault{o}{=} \PYGdefault{n}{atoi}\PYGdefault{p}{(}\PYGdefault{n}{arg}\PYGdefault{p}{);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{n}{ARGP\PYGdefaultZus{}KEY\PYGdefaultZus{}ARG}:
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{n}{ARGP\PYGdefaultZus{}KEY\PYGdefaultZus{}INIT}:
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{steps} \PYGdefault{o}{=} \PYGdefault{n+nb}{false}\PYGdefault{p}{;}
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{method} \PYGdefault{o}{=} \PYGdefault{n}{CANNON}\PYGdefault{p}{;}
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{mode} \PYGdefault{o}{=} \PYGdefault{n}{QUIET}\PYGdefault{p}{;}
            \PYGdefault{n}{arguments}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{pathC} \PYGdefault{o}{=} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{;}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{k}{case} \PYGdefault{n}{ARGP\PYGdefaultZus{}KEY\PYGdefaultZus{}END}:
	        \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{state}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZgt{}}\PYGdefault{n}{arg\PYGdefaultZus{}num} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{)}
                \PYGdefault{n}{argp\PYGdefaultZus{}usage}\PYGdefault{p}{(}\PYGdefault{n}{state}\PYGdefault{p}{);}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{n+nl}{default:} \PYGdefault{k}{return} \PYGdefault{n}{ARGP\PYGdefaultZus{}ERR\PYGdefaultZus{}UNKNOWN}\PYGdefault{p}{;}
    \PYGdefault{p}{\PYGdefaultZcb{}}   
    \PYGdefault{k}{return} \PYGdefault{n}{EXIT\PYGdefaultZus{}SUCCESS}\PYGdefault{p}{;}
\PYGdefault{p}{\PYGdefaultZcb{}}

\PYGdefault{k}{static} \PYGdefault{k}{struct} \PYGdefault{n}{argp} \PYGdefault{n}{argp} \PYGdefault{o}{=} \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{n}{options}\PYGdefault{p}{,} \PYGdefault{n}{parse\PYGdefaultZus{}opt}\PYGdefault{p}{,} \PYGdefault{n}{args\PYGdefaultZus{}doc}\PYGdefault{p}{,} \PYGdefault{n}{doc}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0} \PYGdefault{p}{\PYGdefaultZcb{};}

\PYGdefault{k+kt}{int} \PYGdefault{n+nf}{main}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{argc}\PYGdefault{p}{,} \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{argv}\PYGdefault{p}{[])} \PYGdefault{p}{\PYGdefaultZob{}}
    \PYGdefault{k}{struct} \PYGdefault{n}{arguments} \PYGdefault{n}{arguments}\PYGdefault{p}{;}
    \PYGdefault{n}{argp\PYGdefaultZus{}parse}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{argp}\PYGdefault{p}{,} \PYGdefault{n}{argc}\PYGdefault{p}{,} \PYGdefault{n}{argv}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{arguments}\PYGdefault{p}{);}
    
    \PYGdefault{k+kt}{double} \PYGdefault{n}{t0}\PYGdefault{p}{,} \PYGdefault{n}{t1}\PYGdefault{p}{;} \PYGdefault{c+cm}{/* run\PYGdefaultZhy{}time with data already loaded */}
    \PYGdefault{k+kt}{double} \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{total\PYGdefaultZus{}elap} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{double} \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{=} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{double} \PYGdefault{n}{tmp\PYGdefaultZus{}time0}\PYGdefault{p}{,} \PYGdefault{n}{tmp\PYGdefaultZus{}time1}\PYGdefault{p}{;}

    \PYGdefault{k+kt}{int} \PYGdefault{n}{pid}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{int} \PYGdefault{n}{numprocs}\PYGdefault{p}{;}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Status} \PYGdefault{n}{status}\PYGdefault{p}{;}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Comm} \PYGdefault{n}{cartcom}\PYGdefault{p}{;}

    \PYGdefault{k+kt}{int} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{];}
    \PYGdefault{k+kt}{int} \PYGdefault{n}{period}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{];}
    \PYGdefault{k+kt}{int} \PYGdefault{n}{coord}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{2}\PYGdefault{p}{];}
        
    \PYGdefault{n}{MPI\PYGdefaultZus{}Init}\PYGdefault{p}{(}\PYGdefault{n+nb}{NULL}\PYGdefault{p}{,} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{);}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Comm\PYGdefaultZus{}size}\PYGdefault{p}{(}\PYGdefault{n}{MPI\PYGdefaultZus{}COMM\PYGdefaultZus{}WORLD}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{numprocs}\PYGdefault{p}{);}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Comm\PYGdefaultZus{}rank}\PYGdefault{p}{(}\PYGdefault{n}{MPI\PYGdefaultZus{}COMM\PYGdefaultZus{}WORLD}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{pid}\PYGdefault{p}{);}

    \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
    \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
    \PYGdefault{n}{period}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;}
    \PYGdefault{n}{period}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;}
        
    \PYGdefault{n}{MPI\PYGdefaultZus{}Dims\PYGdefaultZus{}create}\PYGdefault{p}{(}\PYGdefault{n}{numprocs}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{n}{dims}\PYGdefault{p}{);} 
    \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}create}\PYGdefault{p}{(}\PYGdefault{n}{MPI\PYGdefaultZus{}COMM\PYGdefaultZus{}WORLD}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{n}{dims}\PYGdefault{p}{,} \PYGdefault{n}{period}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}coords}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{2}\PYGdefault{p}{,} \PYGdefault{n}{coord}\PYGdefault{p}{);}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Comm\PYGdefaultZus{}rank}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{pid}\PYGdefault{p}{);}

    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{A}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{B}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{C}\PYGdefault{p}{;}

    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{pA}\PYGdefault{p}{;} 
    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{pB}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{pC}\PYGdefault{p}{;} 
    \PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{;}
    \PYGdefault{k+kt}{unsigned} \PYGdefault{k+kt}{int} \PYGdefault{n}{max}\PYGdefault{p}{;} \PYGdefault{c+c1}{// placed here for verbose mode purproses; indices new line;}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Datatype} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{;}

    \PYGdefault{k}{switch} \PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}        
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
        \PYGdefault{k}{case} \PYGdefault{n}{SEQUENTIAL}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}

                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=} 
                                \PYGdefault{n}{A}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{B}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}

\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}

        \PYGdefault{k}{case} \PYGdefault{n}{MKL}:            
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}

                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}                
                \PYGdefault{n}{cblas\PYGdefaultZus{}dgemm}\PYGdefault{p}{(}\PYGdefault{n}{CblasRowMajor}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} 
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{1.0}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} 
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{);}
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{break}\PYGdefault{p}{;}


\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}


        \PYGdefault{k}{case} \PYGdefault{n}{OMP}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{*} 
                        \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} 
                        \PYGdefault{n+nb}{false}\PYGdefault{p}{);}

                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                \PYGdefault{err}{\PYGdefaultZsh{}}\PYGdefault{n}{pragma} \PYGdefault{n}{omp} \PYGdefault{n}{parallel} \PYGdefault{k}{for} \PYGdefault{n}{shared}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{)} \PYGdefault{n}{private}\PYGdefault{p}{(}\PYGdefault{n}{j}\PYGdefault{p}{,}\PYGdefault{n}{l}\PYGdefault{p}{)} \PYGdefault{n}{schedule}\PYGdefault{p}{(}\PYGdefault{k}{static}\PYGdefault{p}{)}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{ii} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;} \PYGdefault{n}{ii}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                   \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=}
                                \PYGdefault{n}{A}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*}
                                \PYGdefault{n}{B}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}            
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}

\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}


        \PYGdefault{k}{case} \PYGdefault{n}{CANNON}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{c+c1}{//lets assume that dims[0] = dims[1]}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{!=} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Process mesh is not appropriate. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;}
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{);} 
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{);}

            \PYGdefault{k+kt}{int} \PYGdefault{n}{sz} \PYGdefault{o}{=} \PYGdefault{n}{max}\PYGdefault{o}{/}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}  \PYGdefault{c+c1}{// row length per block }
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}} 
                \PYGdefault{n}{sz} \PYGdefault{o}{+=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;}
                \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{blockSz} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{sz}\PYGdefault{p}{;}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}contiguous}\PYGdefault{p}{(}\PYGdefault{n}{blockSz}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}DOUBLE}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}commit}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}

            \PYGdefault{n}{pA} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pB} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pC} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pA} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pB} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pC} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}                
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k+kt}{bool} \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{true}\PYGdefault{p}{;}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{==} \PYGdefault{n}{max}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{false}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,}
                    \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n}{resize}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,}
                    \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n}{resize}\PYGdefault{p}{);}
                
                \PYGdefault{c+cm}{/* debug dump */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{6}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sA\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sB\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{c+cm}{/* initial shift with procesor ranks */}                
                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{+} \PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} 
                            \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{A}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                            
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} 
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{c+cm}{/* indeks w macierzy A/B pierwszego elementu z k\PYGdefaultZhy{}tego wiersza */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];} 
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{B}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}                    
                \PYGdefault{p}{\PYGdefaultZcb{}}            
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}                
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{ii} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{ii}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
               \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=}
                            \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{c+cm}{/* dump data for first step  */}
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                        \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                        \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{c+cm}{/* skewing */}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{;}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{right}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{bottom}\PYGdefault{p}{);}
            
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{c+cm}{/* if dims[0] == dims[1] */}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{top}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{ii} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{ii}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                   \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=}
                                \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{c+cm}{/* dump data for step 1\PYGdefaultZhy{}p */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{c+cm}{/* displacement for root process */}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} 
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                        
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}                
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{c+cm}{/* sending computed data from all over the grid to root process*/}
            \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{numprocs}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{proc}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proc}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                    \PYGdefault{c+c1}{// przesunięcia wierszy dla pozostałych procesów}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{c+cm}{/*  proc \PYGdefaultZpc{} dims[1] * sz \PYGdefaultZhy{} first column */}
                    \PYGdefault{c+cm}{/*  of first line of submatrix stored in p\PYGdefaultZhy{}process */}
                    \PYGdefault{c+cm}{/*  (proc / dims[1])... \PYGdefaultZhy{} horizontal shifts */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+}
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}
                            \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}


\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}

        \PYGdefault{k}{case} \PYGdefault{n}{CANNON\PYGdefaultZus{}DGEMM}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}            
            \PYGdefault{c+c1}{//lets assume that dims[0] = dims[1]}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{!=} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Process mesh is not appropriate. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;}
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{);} 
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{);}

            \PYGdefault{k+kt}{int} \PYGdefault{n}{sz} \PYGdefault{o}{=} \PYGdefault{n}{max}\PYGdefault{o}{/}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}  \PYGdefault{c+c1}{// row length per block }

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}} 
                \PYGdefault{n}{sz} \PYGdefault{o}{+=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;}
                \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{k+kt}{int} \PYGdefault{n}{blockSz} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{sz}\PYGdefault{p}{;}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}contiguous}\PYGdefault{p}{(}\PYGdefault{n}{blockSz}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}DOUBLE}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}commit}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}

            \PYGdefault{n}{pA} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pB} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pC} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{tmp\PYGdefaultZus{}pC} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pA} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pB} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pC} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{tmp\PYGdefaultZus{}pC} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{);}
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}
            \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k+kt}{bool} \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{true}\PYGdefault{p}{;}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{==} \PYGdefault{n}{max}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{false}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} 
                        \PYGdefault{n}{resize}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} 
                        \PYGdefault{n}{resize}\PYGdefault{p}{);}

                \PYGdefault{c+cm}{/* debug dump */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{6}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sA\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sB\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}                
                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                \PYGdefault{c+cm}{/* initial shift with procesor ranks */}                
                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{+} \PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{total\PYGdefaultZus{}elap} \PYGdefault{o}{=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{A}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                            
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{total\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} 
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{c+cm}{/* indeks w macierzy A/B pierwszego elementu z k\PYGdefaultZhy{}tego wiersza */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];} 
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{B}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}                    
                \PYGdefault{p}{\PYGdefaultZcb{}}            
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}                
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            

            \PYGdefault{n}{cblas\PYGdefaultZus{}dgemm}\PYGdefault{p}{(}\PYGdefault{n}{CblasRowMajor}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} 
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{1.0}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{);}

            \PYGdefault{c+cm}{/* dump data for first step  */}
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                        \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                        \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{c+cm}{/* skewing */}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{;}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{right}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{bottom}\PYGdefault{p}{);}
            
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{c+cm}{/* if dims[0] == dims[1] */}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{top}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}

               
                \PYGdefault{n}{cblas\PYGdefaultZus{}dgemm}\PYGdefault{p}{(}\PYGdefault{n}{CblasRowMajor}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} \PYGdefault{n}{CblasNoTrans}\PYGdefault{p}{,} 
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{1.0}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{l+m+mf}{0.0}\PYGdefault{p}{,} \PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{);}

                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{blockSz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=} \PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{[}\PYGdefault{n}{j}\PYGdefault{p}{];}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{c+cm}{/* dump data for step 1\PYGdefaultZhy{}p */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{c+cm}{/* displacement for root process */}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} 
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                        
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{c+cm}{/* sending computed data from all over the grid to root process*/}
            \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{numprocs}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{proc}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proc}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{c+c1}{// przesunięcia wierszy dla pozostałych procesów}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{c+cm}{/*  proc \PYGdefaultZpc{} dims[1] * sz \PYGdefaultZhy{} first column */}
                    \PYGdefault{c+cm}{/*  of first line of submatrix stored in p\PYGdefaultZhy{}process */}
                    \PYGdefault{c+cm}{/*  (proc / dims[1])... \PYGdefaultZhy{} horizontal shifts */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+}
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}
                            \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{tmp\PYGdefaultZus{}pC}\PYGdefault{p}{);}            

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}


\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}            
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}
\PYGdefault{c+cm}{/*\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}\PYGdefaultZsh{}*/}

        \PYGdefault{k}{case} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}:
        \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{c+c1}{//lets assume that dims[0] = dims[1]}
            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{!=} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Process mesh is not appropriate. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;}
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{);} 
            \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{)} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}} \PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{);}

            \PYGdefault{k+kt}{int} \PYGdefault{n}{sz} \PYGdefault{o}{=} \PYGdefault{n}{max}\PYGdefault{o}{/}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}  \PYGdefault{c+c1}{// row length per block }

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZgt{}} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{])} \PYGdefault{p}{\PYGdefaultZob{}} 
                \PYGdefault{n}{sz} \PYGdefault{o}{+=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;}
                \PYGdefault{n}{max} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{k+kt}{int} \PYGdefault{n}{blockSz} \PYGdefault{o}{=} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{sz}\PYGdefault{p}{;}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}contiguous}\PYGdefault{p}{(}\PYGdefault{n}{blockSz}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}DOUBLE}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Type\PYGdefaultZus{}commit}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{);}

            \PYGdefault{n}{pA} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pB} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
            \PYGdefault{n}{pC} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}


            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pA} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pB} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{pC} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory. Aborting.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
                \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}
                \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{blockSz} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{A} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{B} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}
                \PYGdefault{n}{C} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{double} \PYGdefault{o}{*}\PYGdefault{p}{)} \PYGdefault{n}{mkl\PYGdefaultZus{}malloc}\PYGdefault{p}{(}\PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{),} \PYGdefault{l+m+mi}{64}\PYGdefault{p}{);}

                \PYGdefault{n}{memset}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{double}\PYGdefault{p}{));}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{A} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{B} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL} \PYGdefault{o}{||} \PYGdefault{n}{C} \PYGdefault{o}{==} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{Couldn\PYGdefaultZsq{}t allocate memory.}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
                    \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}
                    \PYGdefault{n}{exit}\PYGdefault{p}{(}\PYGdefault{n}{EXIT\PYGdefaultZus{}FAILURE}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k+kt}{bool} \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{true}\PYGdefault{p}{;}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{==} \PYGdefault{n}{max} \PYGdefault{o}{\PYGdefaultZam{}\PYGdefaultZam{}}
                    \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k} \PYGdefault{o}{==} \PYGdefault{n}{max}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{resize} \PYGdefault{o}{=} \PYGdefault{n+nb}{false}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathA}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} 
                        \PYGdefault{n}{resize}\PYGdefault{p}{);}
                \PYGdefault{n}{load\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathB}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} 
                        \PYGdefault{n}{resize}\PYGdefault{p}{);}

                \PYGdefault{c+cm}{/* debug dump */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{6}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sA\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{B}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sB\PYGdefaultZus{}raw\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{A}\PYGdefault{p}{,}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{total\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                \PYGdefault{c+cm}{/* initial shift with procesor ranks */}                
                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{+} \PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{i}\PYGdefault{p}{)]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{total\PYGdefaultZus{}elap} \PYGdefault{o}{=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{A}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                            
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{total\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclA}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}A}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                \PYGdefault{k+kt}{int} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{numprocs}\PYGdefault{p}{];}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} 
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{proclB}\PYGdefault{p}{[(}\PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{)} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} 
                                \PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{n}{numprocs} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZgt{}=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{\PYGdefaultZhy{}\PYGdefaultZhy{}}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{c+cm}{/* indeks w macierzy A/B pierwszego elementu z k\PYGdefaultZhy{}tego wiersza */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];} 
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} 
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{B}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                            \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}

                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{!=} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proclB}\PYGdefault{p}{[}\PYGdefault{n}{proc}\PYGdefault{p}{],} 
                                \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}                    
                \PYGdefault{p}{\PYGdefaultZcb{}}            
            \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}                
                \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                        \PYGdefault{n}{DISTRIBUTION\PYGdefaultZus{}B}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
            \PYGdefault{err}{\PYGdefaultZsh{}}\PYGdefault{n}{pragma} \PYGdefault{n}{omp} \PYGdefault{n}{parallel} \PYGdefault{k}{for} \PYGdefault{n}{shared}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{)} \PYGdefault{n}{private}\PYGdefault{p}{(}\PYGdefault{n}{j}\PYGdefault{p}{,}\PYGdefault{n}{l}\PYGdefault{p}{)} \PYGdefault{n}{schedule}\PYGdefault{p}{(}\PYGdefault{k}{static}\PYGdefault{p}{)}
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{ii} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{ii}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
               \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=}
                         \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}            

            \PYGdefault{c+cm}{/* dump data for first step  */}
            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                        \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                        \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}0000\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{);}
                \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                    \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{c+cm}{/* skewing */}
            \PYGdefault{k+kt}{int} \PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{;}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{left}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{right}\PYGdefault{p}{);}
            \PYGdefault{n}{MPI\PYGdefaultZus{}Cart\PYGdefaultZus{}shift}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{top}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{bottom}\PYGdefault{p}{);}
            
            \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{];} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}} \PYGdefault{c+cm}{/* if dims[0] == dims[1] */}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{left}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{right}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}LEFTRIGHT}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
                \PYGdefault{n}{MPI\PYGdefaultZus{}Sendrecv\PYGdefaultZus{}replace}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{top}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{bottom}\PYGdefault{p}{,} 
                        \PYGdefault{n}{SKEW\PYGdefaultZus{}BOTTOMUP}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}

                \PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;}
                \PYGdefault{err}{\PYGdefaultZsh{}}\PYGdefault{n}{pragma} \PYGdefault{n}{omp} \PYGdefault{n}{parallel} \PYGdefault{k}{for} \PYGdefault{n}{shared}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{)} \PYGdefault{n}{private}\PYGdefault{p}{(}\PYGdefault{n}{j}\PYGdefault{p}{,}\PYGdefault{n}{l}\PYGdefault{p}{)} \PYGdefault{n}{schedule}\PYGdefault{p}{(}\PYGdefault{k}{static}\PYGdefault{p}{)}
                \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{ii} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{ii} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{ii}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                   \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for} \PYGdefault{p}{(}\PYGdefault{n}{l} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{l} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{l}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{+=} 
                                \PYGdefault{n}{pA}\PYGdefault{p}{[}\PYGdefault{n}{ii} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{l}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{pB}\PYGdefault{p}{[}\PYGdefault{n}{l} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{c+cm}{/* dump data for step 1\PYGdefaultZhy{}p */}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{steps}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{n}{dump\PYGdefaultZus{}path} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{k+kt}{char} \PYGdefault{o}{*}\PYGdefault{p}{)}\PYGdefault{n}{malloc}\PYGdefault{p}{(}
                            \PYGdefault{p}{(}\PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)} \PYGdefault{o}{+} \PYGdefault{l+m+mi}{12}\PYGdefault{p}{)}
                            \PYGdefault{o}{*} \PYGdefault{k}{sizeof}\PYGdefault{p}{(}\PYGdefault{k+kt}{char}\PYGdefault{p}{));}
                    \PYGdefault{c+cm}{/* assuming that theres less than 9999 nodes */}
                    \PYGdefault{c+cm}{/* that gives less than 9999 steps to dump   */}
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}A\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pA}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}B\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pB}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}s\PYGdefaultZpc{}04d\PYGdefaultZus{}\PYGdefaultZpc{}04d\PYGdefaultZus{}C\PYGdefaultZdq{}}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{n}{pid}\PYGdefault{p}{,} \PYGdefault{n}{i}\PYGdefault{p}{);}
                    \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{,} \PYGdefault{n}{pC}\PYGdefault{p}{,}
                        \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n}{sz}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{,} \PYGdefault{n+nb}{true}\PYGdefault{p}{);}

                    \PYGdefault{n}{free}\PYGdefault{p}{(}\PYGdefault{n}{dump\PYGdefaultZus{}path}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{n}{MPI\PYGdefaultZus{}Barrier}\PYGdefault{p}{(}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}

            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{c+cm}{/* displacement for root process */}
                \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} 
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}  
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}                        
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{c+cm}{/* sending computed data from all over the grid to root process*/}
            \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{proc} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{numprocs}\PYGdefault{p}{;} \PYGdefault{n}{proc}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{proc}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Send}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{ROOT}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{n}{MPI\PYGdefaultZus{}Recv}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{,} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{,} \PYGdefault{n}{MPI\PYGdefaultZus{}SUBMATRIX}\PYGdefault{p}{,} \PYGdefault{n}{proc}\PYGdefault{p}{,} 
                            \PYGdefault{n}{COLLECTING}\PYGdefault{p}{,} \PYGdefault{n}{cartcom}\PYGdefault{p}{,} \PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{status}\PYGdefault{p}{);}
                    \PYGdefault{c+c1}{// przesunięcia wierszy dla pozostałych procesów}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t0} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}

                    \PYGdefault{k+kt}{int} \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{sz}\PYGdefault{p}{];}
                    \PYGdefault{c+cm}{/*  proc \PYGdefaultZpc{} dims[1] * sz \PYGdefaultZhy{} first column */}
                    \PYGdefault{c+cm}{/*  of first line of submatrix stored in p\PYGdefaultZhy{}process */}
                    \PYGdefault{c+cm}{/*  (proc / dims[1])... \PYGdefaultZhy{} horizontal shifts */}
                    \PYGdefault{k+kt}{int} \PYGdefault{n}{start} \PYGdefault{o}{=} \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{\PYGdefaultZpc{}} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+}
                        \PYGdefault{p}{(}\PYGdefault{n}{proc} \PYGdefault{o}{/} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{])} \PYGdefault{o}{*} \PYGdefault{p}{(}\PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{*} \PYGdefault{n}{blockSz}\PYGdefault{p}{);}
                    \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{start}\PYGdefault{p}{;}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{k} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{;} \PYGdefault{n}{k} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{k}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}              
                        \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{p}{]} \PYGdefault{o}{=}
                            \PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{k}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{sz} \PYGdefault{o}{*} \PYGdefault{n}{dims}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{];}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{sz}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{displacements}\PYGdefault{p}{[}\PYGdefault{n}{i}\PYGdefault{p}{]} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]} \PYGdefault{o}{=} \PYGdefault{n}{pC}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{sz} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{];}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                    \PYGdefault{n}{seq\PYGdefaultZus{}elap} \PYGdefault{o}{+=} \PYGdefault{n}{seq\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{seq\PYGdefaultZus{}t0}\PYGdefault{p}{;}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pA}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pB}\PYGdefault{p}{);}
            \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{pC}\PYGdefault{p}{);}

            \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
                \PYGdefault{n}{t1} \PYGdefault{o}{=} \PYGdefault{n}{MPI\PYGdefaultZus{}Wtime}\PYGdefault{p}{();}
            \PYGdefault{p}{\PYGdefaultZcb{}}

            \PYGdefault{k}{break}\PYGdefault{p}{;}
        \PYGdefault{p}{\PYGdefaultZcb{}}
    \PYGdefault{p}{\PYGdefaultZcb{}}

    \PYGdefault{c+cm}{/* comunication time collecting */}
    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{pid} \PYGdefault{o}{==} \PYGdefault{n}{ROOT}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}    
        \PYGdefault{k}{switch}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{mode}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
            \PYGdefault{k}{case} \PYGdefault{n}{VERBOSE}: \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON} \PYGdefault{o}{||} 
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON\PYGdefaultZus{}DGEMM} \PYGdefault{o}{||}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}.0lf}\PYGdefault{l+s+se}{\PYGdefaultZbs{}t}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{max} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]);}
                            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{==} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)} \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{i} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{i} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{;} \PYGdefault{n}{i}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{for}\PYGdefault{p}{(}\PYGdefault{k+kt}{int} \PYGdefault{n}{j} \PYGdefault{o}{=} \PYGdefault{l+m+mi}{0}\PYGdefault{p}{;} \PYGdefault{n}{j} \PYGdefault{o}{\PYGdefaultZlt{}} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{;} \PYGdefault{n}{j}\PYGdefault{o}{++}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}.0lf}\PYGdefault{l+s+se}{\PYGdefaultZbs{}t}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{[}\PYGdefault{n}{i} \PYGdefault{o}{*} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{+} \PYGdefault{n}{j}\PYGdefault{p}{]);}
                            \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{j} \PYGdefault{o}{==} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{l+m+mi}{1}\PYGdefault{p}{)} \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{);}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{p}{\PYGdefaultZcb{}}
            \PYGdefault{k}{case} \PYGdefault{n}{QUIET}:
            \PYGdefault{p}{\PYGdefaultZob{}}
                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{time} \PYGdefault{o}{==} \PYGdefault{n+nb}{true} \PYGdefault{o}{||} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{mode} \PYGdefault{o}{==} \PYGdefault{n}{VERBOSE}\PYGdefault{p}{)}
                    \PYGdefault{n}{printf}\PYGdefault{p}{(}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{ETA: \PYGdefaultZpc{}lf}\PYGdefault{l+s+se}{\PYGdefaultZbs{}n}\PYGdefault{l+s}{\PYGdefaultZdq{}}\PYGdefault{p}{,} \PYGdefault{n}{t1}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{n}{t0}\PYGdefault{p}{);}

                \PYGdefault{k}{if} \PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathC} \PYGdefault{o}{!=} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON} \PYGdefault{o}{||} 
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON\PYGdefaultZus{}DGEMM} \PYGdefault{o}{||}
                        \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method} \PYGdefault{o}{==} \PYGdefault{n}{CANNON\PYGdefaultZus{}OMP}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathC}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{,}
                                \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{max}\PYGdefault{p}{,} 
                                \PYGdefault{n+nb}{false}\PYGdefault{p}{,} \PYGdefault{n+nb}{false}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}} \PYGdefault{k}{else} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{n}{save\PYGdefaultZus{}matrix}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{pathC}\PYGdefault{p}{,} \PYGdefault{n}{C}\PYGdefault{p}{,}
                                \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,}  \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} 
                                \PYGdefault{n+nb}{false}\PYGdefault{p}{,} \PYGdefault{n+nb}{false}\PYGdefault{p}{);}
                    \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{p}{\PYGdefaultZcb{}}

                \PYGdefault{k}{if}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir} \PYGdefault{o}{!=} \PYGdefault{n+nb}{NULL}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                    \PYGdefault{k+kt}{char} \PYGdefault{n}{filename}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{15} \PYGdefault{o}{+} \PYGdefault{n}{strlen}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{)];}             
                    \PYGdefault{k+kt}{char} \PYGdefault{n}{method}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{];}
                    
                    \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{,}\PYGdefault{l+s}{\PYGdefaultZdq{}\PYGdefaultZpc{}sdebug\PYGdefaultZus{}\PYGdefaultZpc{}d\PYGdefaultZdq{}}\PYGdefault{p}{,}
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{debugDir}\PYGdefault{p}{,} \PYGdefault{p}{(}\PYGdefault{k+kt}{unsigned}\PYGdefault{p}{)}\PYGdefault{n}{time}\PYGdefault{p}{(}\PYGdefault{n+nb}{NULL}\PYGdefault{p}{));}

                    \PYGdefault{k}{switch}\PYGdefault{p}{(}\PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{method}\PYGdefault{p}{)} \PYGdefault{p}{\PYGdefaultZob{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{0}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}SEQUENTIAL\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{1}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}MKL\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{2}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}OMP\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{3}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{4}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZus{}DGEMM\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                        \PYGdefault{k}{case} \PYGdefault{l+m+mi}{5}: \PYGdefault{p}{\PYGdefaultZob{}}
                            \PYGdefault{n}{sprintf}\PYGdefault{p}{(}\PYGdefault{n}{method}\PYGdefault{p}{,} \PYGdefault{l+s}{\PYGdefaultZdq{}CANNON\PYGdefaultZus{}OMP\PYGdefaultZdq{}}\PYGdefault{p}{);}
                            \PYGdefault{k}{break}\PYGdefault{p}{;}
                        \PYGdefault{p}{\PYGdefaultZcb{}}
                    \PYGdefault{p}{\PYGdefaultZcb{}}

                    \PYGdefault{n}{save\PYGdefaultZus{}info}\PYGdefault{p}{(}\PYGdefault{n}{filename}\PYGdefault{p}{,} \PYGdefault{n}{t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{t0}\PYGdefault{p}{,} \PYGdefault{n}{method}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{m}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{k}\PYGdefault{p}{,} \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{n}\PYGdefault{p}{,} \PYGdefault{n}{numprocs}\PYGdefault{p}{,} 
                            \PYGdefault{n}{arguments}\PYGdefault{p}{.}\PYGdefault{n}{omp\PYGdefaultZus{}threads}\PYGdefault{p}{,} \PYGdefault{n}{seq\PYGdefaultZus{}elap}\PYGdefault{p}{,} \PYGdefault{n}{total\PYGdefaultZus{}t1} \PYGdefault{o}{\PYGdefaultZhy{}} \PYGdefault{n}{total\PYGdefaultZus{}t0}\PYGdefault{p}{);}
                \PYGdefault{p}{\PYGdefaultZcb{}}
                \PYGdefault{k}{break}\PYGdefault{p}{;}
            \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{p}{\PYGdefaultZcb{}}
        \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{A}\PYGdefault{p}{);}
        \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{B}\PYGdefault{p}{);}
        \PYGdefault{n}{mkl\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{n}{C}\PYGdefault{p}{);}        
    \PYGdefault{p}{\PYGdefaultZcb{}}

    \PYGdefault{n}{MPI\PYGdefaultZus{}Comm\PYGdefaultZus{}free}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZam{}}\PYGdefault{n}{cartcom}\PYGdefault{p}{);}
    \PYGdefault{n}{MPI\PYGdefaultZus{}Finalize}\PYGdefault{p}{();}
    \PYGdefault{k}{return} \PYGdefault{n}{EXIT\PYGdefaultZus{}SUCCESS}\PYGdefault{p}{;}
\PYGdefault{p}{\PYGdefaultZcb{}}
\end{Verbatim}
